import numpy as np
from Transient import transient
import math
from scipy import linalg

K = np.array([[ 1.0240,  0.1280, -1.0240,  0.1280,       0,       0,       0,       0,       0,       0],
              [ 0.1280,  0.0213, -0.1280,  0.0107,       0,       0,       0,       0,       0,       0],
              [-1.0240, -0.1280,  2.0480,       0, -1.0240,  0.1280,       0,       0,       0,       0],
              [ 0.1280,  0.0107,       0,  0.0427, -0.1280,  0.0107,       0,       0,       0,       0],
              [      0,       0, -1.0240, -0.1280,  2.0480,       0, -1.0240,  0.1280,       0,       0],
              [      0,       0,  0.1280,  0.0107,       0,  0.0427, -0.1280,  0.0107,       0,       0],
              [      0,       0,       0,       0, -1.0240, -0.1280,  2.0480,       0, -1.0240,  0.1280],
              [      0,       0,       0,       0,  0.1280,  0.0107,       0,  0.0427, -0.1280,  0.0107],
              [      0,       0,       0,       0,       0,       0, -1.0240, -0.1280,  1.0240, -0.1280],
              [      0,       0,       0,       0,       0,       0,  0.1280,  0.0107, -0.1280,  0.0213]])

K *= 1.0e+06

M = np.array([[ 0.3714,  0.0131,  0.1286, -0.0077,       0,       0,       0,       0,       0,       0],
              [ 0.0131,  0.0006,  0.0077, -0.0004,       0,       0,       0,       0,       0,       0],
              [ 0.1286,  0.0077,  0.7429,       0,  0.1286, -0.0077,       0,       0,       0,       0],
              [-0.0077, -0.0004,       0,  0.0012,  0.0077, -0.0004,       0,       0,       0,       0],
              [      0,       0,  0.1286,  0.0077,  0.7429,       0,  0.1286, -0.0077,       0,       0],
              [      0,       0, -0.0077, -0.0004,       0,  0.0012,  0.0077, -0.0004,       0,       0],
              [      0,       0,       0,       0,  0.1286,  0.0077,  0.7429,       0,  0.1286, -0.0077],
              [      0,       0,       0,       0, -0.0077, -0.0004,       0,  0.0012,  0.0077, -0.0004],
              [      0,       0,       0,       0,       0,       0,  0.1286,  0.0077,  0.3714, -0.0131],
              [      0,       0,       0,       0,       0,       0, -0.0077, -0.0004, -0.0131,  0.0006]])

#Minv = linalg.inv(M)
#print(Minv)

force = np.array([[   0, 0, 0],
                  [   0, 0, 0],
                  [   0, 0, 0],
                  [   0, 0, 0],
                  [   0, 0, 0],
                  [   0, 0, 0],
                  [   0, 0, 0],
                  [   0, 0, 0],
                  [ 100, 0, 0],
                  [   0, 0, 0]])

C = np.zeros((10, 10))


disp_0 = np.zeros((10, 1))
vel_0 = np.zeros((10, 1))
t_step = 0.0001
t_0 = 0
t_f = 0.2

# K = np.delete(K, [0, 1], 0)
# K = np.delete(K, [0, 1], 1)
# M = np.delete(M, [0, 1], 0)
# M = np.delete(M, [0, 1], 1)
# C = np.delete(C, [0, 1], 0)
# C = np.delete(C, [0, 1], 1)
# force = np.delete(force, [0, 1], 0)
# disp_0 = np.delete(disp_0, [0, 1], 0)
# vel_0 = np.delete(vel_0, [0, 1], 0)

transient(M,
          K,
          C,
          force,
          disp_0,
          vel_0,
          t_step,
          t_0,
          t_f)


